{
    "user_msg_template": "Patient: {text}\n\nQuestion: Does this patient have insomnia?\nOutput in JSON format: ",
    "arr_prompt_examples" : [
        1,
        2,
        3,
        4,
        1261284,
        11834,
        56727,
        1267520
    ],
    "prompt": [
        {
            "role": "system",
            "content": "You are an expert clinician trained to identify signs of insomnia from clinical notes, following established diagnostic criteria. Your task is to read a clinical note and return a structured JSON object containing your decisions and justifications for each insomnia-related rule.\n\nYou must strictly follow the definitions and medication lists below. Do not use any medication that is not explicitly included.\n\nDefinitions:\n\nDefinition 1: Difficulty Sleeping\nThe patient is considered to have difficulty sleeping if they report any of the following:\n1. Trouble initiating sleep.\n2. Trouble maintaining sleep.\n3. Waking up earlier than desired.\n4. An explicit mention of insomnia.\n\nDefinition 2: Daytime Impairment\nThe patient is considered to have daytime impairment if they report any of the following:\n1. Fatigue or malaise.\n2. Impaired attention, concentration, or memory.\n3. Impaired social, family, occupational, or academic performance.\n4. Mood disturbance or irritability.\n5. Daytime sleepiness.\n6. Behavioral problems such as hyperactivity, impulsivity, or aggression.\n7. Decreased motivation, energy, or initiative.\n8. Proneness to errors or accidents.\n9. Concerns or dissatisfaction with sleep.\n10. An explicit mention of insomnia.\n\nRules:\n\nRule A: The patient has insomnia if both Definition 1 and Definition 2 are met.\n\nRule B: The patient has insomnia if prescribed **any of the following primary insomnia medications**:\nEstazolam, Eszopiclone, Flurazepam, Lemborexant, Quazepam, Ramelteon, Suvorexant, Temazepam, Triazolam, Zaleplon, Zolpidem, Zolpidem CR. \n- **Important**: Only the medications listed above may be used for Rule B. Do not infer or assume based on other medications.\n\nRule C: The patient has insomnia if:\n- They are prescribed **any of the following secondary insomnia medications**, **AND**\n- They exhibit any symptom from Definition 1 or Definition 2.\nValid secondary insomnia medications: Acamprosate, Alprazolam, Clonazepam, Clonidine, Diazepam (Valium), Diphenhydramine, Doxepin, Gabapentin, Hydroxyzine, Lorazepam (Ativan), Melatonin, Mirtazapine, Olanzapine, Quetiapine, Trazodone.\n- **Important**: **Only** the above medications may be considered for Rule C. You must not use any unlisted drug, even if it is sedative or commonly used for sleep. Do not rely on external knowledge.\n\nInsomnia status:\nAnswer \"yes\" if any of Rule A, Rule B, or Rule C is met. Otherwise, answer \"no.\"\n\n\nInput Format:\n\"Patient: [clinical note]\nQuestion: Does this patient have insomnia?\"\n\nOutput Format:\nReturn your full answer strictly in valid JSON format using the following template. When citing the text from the clinical notes, escape all internal double quotes (`\"`) using a backslash (`\\\"`) to ensure the output is valid JSON.\n\"Output in JSON format: {\n    \"definition_1\": {\n        \"explanation\": \"[Your detailed justification based on the clinical note]\",\n        \"answer\": \"[yes or no]\"\n    },\n    \"definition_2\": {\n        \"explanation\": \"[Your detailed justification based on the clinical note]\",\n        \"answer\": \"[yes or no]\"\n    },\n    \"rule_a\": {\n        \"explanation\": \"[Your justification based on the previous answers for Definition 1, and 2]\",\n        \"answer\": \"[yes or no]\"\n    },\n    \"rule_b\": {\n        \"explanation\": \"[Your detailed justification based on the clinical note]\",\n        \"answer\": \"[yes or no]\"\n    },\n    \"rule_c\": {\n        \"explanation\": \"[Your detailed justification based on the clinical note]\",\n        \"answer\": \"[yes or no]\"\n    },\n    \"insomnia_status\": {\n        \"explanation\": \"[Your justification based on the previous answers for Rule A, B, and C]\",\n        \"answer\": \"[yes or no]\"\n    }\n}\""
        },
        {
            "role": "user",
            "content": "Patient: [KUMC note ID: 1]\n\nQuestion: Does this patient have insomnia?\nOutput in JSON format: "
        },
        {
            "role": "assistant",
            "content": "{\n    \"definition_1\": {\n        \"explanation\": \"The patient does not have difficulty sleeping.\",\n        \"answer\": \"no\"\n    },\n    \"definition_2\": {\n        \"explanation\": \"The patient does not report any symptoms related to daytime impairment.\",\n        \"answer\": \"no\"\n    },\n    \"rule_a\": {\n        \"explanation\": \"The patient does not have difficulty sleeping (Definition 1) and does not exhibit daytime impairment (Definition 2); therefore, Rule A is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_b\": {\n        \"explanation\": \"The patient is not prescribed any primary insomnia medication; therefore, Rule B is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_c\": {\n        \"explanation\": \"The patient is prescribed gabapentin, but he does not have difficulty sleeping (Definition 1) or daytime impairment (Definition 2); therefore, Rule C is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"insomnia_status\": {\n        \"explanation\": \"The patient does not meet the criteria for insomnia under Rule A, Rule B or Rule C.\",\n        \"answer\": \"no\"\n    }\n}"
        },
        {
            "role": "user",
            "content": "Patient: [KUMC note ID: 2]\n\nQuestion: Does this patient have insomnia?\nOutput in JSON format: "
        },
        {
            "role": "assistant",
            "content": "{\n    \"definition_1\": {\n        \"explanation\": \"The patient has difficulty sleeping, as indicated by the clinical note: \\\"She is having a hard time staying asleep at night. She usually fall asleep fairly easily but seems to wake up middle of the night and most nights is hard for her to go back to sleep\\\", and \\\"Insomnia, unspecified type\\\".\",\n        \"answer\": \"yes\"\n    },\n    \"definition_2\": {\n        \"explanation\": \"The patient reports symptoms related to daytime impairment: concerns or dissatisfaction with sleep (as indicated by the clinical note: \\\"patient is here by herself for follow up of her blood pressure, edema, and problems with sleep\\\", and \\\"She is interested in trying something to help with sleep\\\"), and \\\"Insomnia, unspecified type\\\".\",\n        \"answer\": \"yes\"\n    },\n    \"rule_a\": {\n        \"explanation\": \"The patient has difficulty sleeping (Definition 1) and exhibits daytime impairment (Definition 2); therefore, Rule A is satisfied.\",\n        \"answer\": \"yes\"\n    },\n    \"rule_b\": {\n        \"explanation\": \"The patient is not prescribed any primary insomnia medication; therefore, Rule B is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_c\": {\n        \"explanation\": \"The patient is prescribed melatonin and has difficulty sleeping (Definition 1) and daytime impairment (Definition 2); therefore, Rule C is satisfied.\",\n        \"answer\": \"yes\"\n    },\n    \"insomnia_status\": {\n        \"explanation\": \"The patient meets the criteria for insomnia under Rule A and Rule C.\",\n        \"answer\": \"yes\"\n    }\n}"
        },
        {
            "role": "user",
            "content": "Patient: [KUMC note ID: 3]\n\nQuestion: Does this patient have insomnia?\nOutput in JSON format: "
        },
        {
            "role": "assistant",
            "content": "{\n    \"definition_1\": {\n        \"explanation\": \" The patient does not have difficulty sleeping.\",\n        \"answer\": \"no\"\n    },\n    \"definition_2\": {\n        \"explanation\": \"The patient does not report any symptoms related to daytime impairment.\",\n        \"answer\": \"no\"\n    },\n    \"rule_a\": {\n        \"explanation\": \"The patient does not have difficulty sleeping (Definition 1) and does not exhibit daytime impairment (Definition 2); therefore, Rule A is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_b\": {\n        \"explanation\": \"The patient is not prescribed any primary insomnia medication; therefore, Rule B is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_c\": {\n        \"explanation\": \"The patient is not prescribed any secondary insomnia medication; therefore, Rule C is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"insomnia_status\": {\n        \"explanation\": \"The patient does not meet the criteria for insomnia under Rule A, Rule B or Rule C.\",\n        \"answer\": \"no\"\n    }\n}"
        },
        {
            "role": "user",
            "content": "Patient: [KUMC note ID: 4]\n\nQuestion: Does this patient have insomnia?\nOutput in JSON format: "
        },
        {
            "role": "assistant",
            "content": "{\n    \"definition_1\": {\n        \"explanation\": \"The patient does not have difficulty sleeping.\",\n        \"answer\": \"no\"\n    },\n    \"definition_2\": {\n        \"explanation\": \"The patient does not report any symptoms related to daytime impairment.\",\n        \"answer\": \"no\"\n    },\n    \"rule_a\": {\n        \"explanation\": \"The patient does not have difficulty sleeping (Definition 1) and does not exhibit daytime impairment (Definition 2); therefore, Rule A is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_b\": {\n        \"explanation\": \"The patient is not prescribed any primary insomnia medication; therefore, Rule B is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_c\": {\n        \"explanation\": \"The patient is not prescribed any secondary insomnia medication; therefore, Rule C is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"insomnia_status\": {\n        \"explanation\": \"The patient does not meet the criteria for insomnia under Rule A, Rule B or Rule C.\",\n        \"answer\": \"no\"\n    }\n}"
        },
        {
            "role": "user",
            "content": "Patient: [MIMIC note ID: 1261284]\n\nQuestion: Does this patient have insomnia?\nOutput in JSON format: "
        },
        {
            "role": "assistant",
            "content": "{\n    \"definition_1\": {\n        \"explanation\": \"The patient has difficulty sleeping, as indicated by the clinical note: \\\"he had trouble sleeping\\\" and \\\"has not slept in over 3 days\\\".\",\n        \"answer\": \"yes\"\n    },\n    \"definition_2\": {\n        \"explanation\": \"The patient reports symptoms related to daytime impairment: fatigue (as indicated by the clinical note: \\\"He is extremely tired\\\") and concerns or dissatisfaction with sleep (\\\"just wants to sleep\\\").\",\n        \"answer\": \"yes\"\n    },\n    \"rule_a\": {\n        \"explanation\": \"The patient has difficulty sleeping (Definition 1) and exhibits daytime impairment (Definition 2); therefore, Rule A is satisfied.\",\n        \"answer\": \"yes\"\n    },\n    \"rule_b\": {\n        \"explanation\": \"The patient is prescribed Zolpidem, a primary insomnia medication; therefore, Rule B is satisfied.\",\n        \"answer\": \"yes\"\n    },\n    \"rule_c\": {\n        \"explanation\": \"The patient is prescribed Gabapentin and has difficulty sleeping (Definition 1) and daytime impairment (Definition 2); therefore, Rule C is satisfied.\",\n        \"answer\": \"yes\"\n    },\n    \"insomnia_status\": {\n        \"explanation\": \"The patient meets the criteria for insomnia under Rule A, Rule B, and Rule C.\",\n        \"answer\": \"yes\"\n    }\n}"
        },
        {
            "role": "user",
            "content": "Patient: [MIMIC note ID: 11834]\n\nQuestion: Does this patient have insomnia?\nOutput in JSON format: "
        },
        {
            "role": "assistant",
            "content": "{\n    \"definition_1\": {\n        \"explanation\": \"The patient does not have difficulty sleeping, as indicated by the clinical note: \\\"sleeping a lot\\\".\",\n        \"answer\": \"no\"\n    },\n    \"definition_2\": {\n        \"explanation\": \"The patient does not report any symptoms related to daytime impairment that could likely be attributed to insomnia. The clinical note: \\\"He reports that for the last 2 weeks, he has worsened unsteadiness and has been very tired, sleeping a lot. He thinks this is due to his XRT treatments which finished 6 days prior to admission\\\" indicates that the patient's fatigue and daytime sleepiness is due to his cancer treatments, and not insomnia.\",\n        \"answer\": \"no\"\n    },\n    \"rule_a\": {\n        \"explanation\": \"The patient does not have difficulty sleeping (Definition 1) and does not exhibit daytime impairment (Definition 2); therefore, Rule A is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_b\": {\n        \"explanation\": \"The patient is not prescribed any primary insomnia medication; therefore, Rule B is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_c\": {\n        \"explanation\": \"The patient is prescribed Lorazepam, but he does not have difficulty sleeping (Definition 1) or daytime impairment (Definition 2); therefore, Rule C is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"insomnia_status\": {\n        \"explanation\": \"The patient does not meet the criteria under Rule A, Rule B, or Rule C.\",\n        \"answer\": \"no\"\n    }\n}"
        },
        {
            "role": "user",
            "content": "Patient: [MIMIC note ID: 56727]\n\nQuestion: Does this patient have insomnia?\nOutput in JSON format: "
        },
        {
            "role": "assistant",
            "content": "{\n    \"definition_1\": {\n        \"explanation\": \"The patient has difficulty sleeping, as indicated by the clinical note: \\\"insomnia\\\".\",\n        \"answer\": \"yes\"\n    },\n    \"definition_2\": {\n        \"explanation\": \"The patient reports symptoms related to daytime impairment, as indicated by the clinical note: \\\"insomnia\\\".\",\n        \"answer\": \"yes\"\n    },\n    \"rule_a\": {\n        \"explanation\": \"The patient has difficulty sleeping (Definition 1) and exhibits daytime impairment (Definition 2); therefore, Rule A is satisfied.\",\n        \"answer\": \"yes\"\n    },\n    \"rule_b\": {\n        \"explanation\": \"The patient is prescribed Zolpidem, a primary insomnia medication; therefore, Rule B is satisfied.\",\n        \"answer\": \"yes\"\n    },\n    \"rule_c\": {\n        \"explanation\": \"The patient is prescribed Lorazepam and Clonazepam and has difficulty sleeping (Definition 1) and daytime impairment (Definition 2); therefore, Rule C is satisfied.\",\n        \"answer\": \"yes\"\n    },\n    \"insomnia_status\": {\n        \"explanation\": \"The patient meets the criteria for insomnia under Rule A, Rule B, and Rule C.\",\n        \"answer\": \"yes\"\n    }\n}"
        },
        {
            "role": "user",
            "content": "Patient: [MIMIC note ID: 1267520]\n\nQuestion: Does this patient have insomnia?\nOutput in JSON format: "
        },
        {
            "role": "assistant",
            "content": "{\n    \"definition_1\": {\n        \"explanation\": \"The patient does not have difficulty sleeping that could likely be attributed to insomnia. The clinical note: \\\"he was unable to sleep d/t persistent coughing and bronchospasm\\\" indicates that the patient\u2019s sleep difficulty is due to his persistent coughing and bronchospasm, and not insomnia.\",\n        \"answer\": \"no\"\n    },\n    \"definition_2\": {\n        \"explanation\": \"The patient reports symptoms related to daytime impairment: fatigue (as indicated by the clinical note: \\\"extremely fatigued this morning\\\").\",\n        \"answer\": \"yes\"\n    },\n    \"rule_a\": {\n        \"explanation\": \"The patient exhibits daytime impairment (Definition 2) but does not have difficulty sleeping (Definition 1); therefore, Rule A is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_b\": {\n        \"explanation\": \"The patient is not prescribed any primary insomnia medication; therefore, Rule B is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"rule_c\": {\n        \"explanation\": \"The patient is not prescribed any secondary insomnia medication; therefore, Rule C is not satisfied.\",\n        \"answer\": \"no\"\n    },\n    \"insomnia_status\": {\n        \"explanation\": \"The patient does not meet the criteria for insomnia under Rule A, Rule B, or Rule C.\",\n        \"answer\": \"no\"\n    }\n}"
        }
    ]
}